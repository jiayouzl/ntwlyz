<p align="center"><img src="http://tva1.sinaimg.cn/large/0060lm7Tly1g5a7zy2lphj30sg0e07b2.jpg"></p>

## 为什么要开发Ntwlyz

最近有个朋友想要写一套这样功能的网络验证系统但他不会Web开发，我近期也有空闲时间，帮他完成了。后续我也会对该项目于进行更新以达到符合更多人的需求。

## Ntwlyz的开发环境

1. PHP 7.1.30
2. Laravel 5.8.29（最低需要PHP7.1.03）
3. MySQL 5.5.53
4. Windows 10 Pro 1903

## Ntwlyz后续计划

* ~~安全的`动态加解密`技术~~(已完成)
    * 近期有空就会加入这个，对于网络验证而言数据交互之间的加密还是必须要有滴。
* ~~远程载入功能代码。~~(已完成)
	* 将重要代码以DLL动态链接库形式编译，将其上传至服务器，通过内存加载的方式调用远程DLL中的函数，从而达到代码分离的效果，为防破解添加一道防护。
* 欢迎所有`Laravel`爱好者一起充实它。

## 安装说明

1. 自行导入NTSQL文件夹中的data.sql文件到MySQL。
2. 自行修改根目录中.env.example中的配置后改名.env。(修改APP_URL与MySQL连接配置)
3. 执行composer install安装所需扩展包。
4. Nginx需将运行目录指定至项目public目录。
5. 配置Laravel所需的伪静态规则。

## 接口说明

注册与验证通用接口（GET）
`http://name.app/rules/login?key={key}`[未开启Url签名验证(默认开启)]

注册与验证通用接口（GET）
`http://name.app/rules/urlsign?key={key}`[已开启Url签名验证]该接口返回的值即是签名过的Url

充值接口（GET）
`http://name.app/rules/pay?key={key}&card={card}&password={password}`

授权转绑接口(GET)
`http://name.app/rules/replace?key1={key1}&key2={key2}`

管理后台(name:admin,password:admin)
`http://name.app/admin`

## 返回码说明

* 1000 用户未过期验证通过
* 1001 新用户注册成功
* 1002 充值成功
* 1003 授权转绑成功
* 
* 2000 用户已过期
* 2001 新用户注册失败
* 2002 充值卡号或密码错误
* 2003 充值卡已被使用
* 2004 充值失败
* 2005 需充值的Key不存在
* 2006 该充值卡被封请于售卡商取得联系
* 2007 被转绑的机器码有效期小于3天无法转绑
* 2008 被转绑的机器码冷却时间小于30天无法转绑
* 2009 被转绑的机器码不存在
* 2010 待转绑的机器码不存在
* 2011 被转与待转机器码不可重复
* 2012 授权转移功能未开启
* 
* 3000 登录参数错误
* 3001 充值参数错误
* 3002 URL签名认证失败
* 3003 授权转绑参数错误
* 3004 机器码格式错误
* 
* 4000 维护中请稍后在重试。

## 更新日志

更新内容(2021年10月17日)     v1.64
1. 升级Laravel修复漏洞.

更新内容(2019年8月12日)      v1.63
1. 对提交过来的机器码参数做了较为严谨的判断,如格式不正确返回3004错误.
2. 长度大于32或机器码中除了英文与数字外的任何字符串均视为错误.
3. 修复了生成Url签名时一个潜在的Bug.
4. 细节优化.

更新内容(2019年8月7日)      v1.62
1. 有用户反映Sql文件有问题对此更新.

更新内容(2019年8月4日)      v1.61
1. 由于接口慢慢变多了,原先的单独路由改用路由组进行管理.
2. 后台增加是否开启授权转移开关.
3. 增加关闭授权转移的返回码.

更新内容(2019年8月2日)      v1.60
1. 调整后台菜单分类.
2. 增加用户登录日志列表查询.
3. 增加授权转绑功能.(未到期且到期时间＞3天并上次转绑时间＞30天可自行转移授权操作)
4. 增加授权转绑日志列表查询.
5. DEMO增加授权转绑示范.

更新内容(2019年8月1日)      v1.52
1. 优化Url签名认证代码,取消直接403错误增加签名失败错误码:3002.
2. 后台系统设置增加是否开启Url签名开关.

更新内容(2019年7月29日)     v1.51
1. 登录验证接口增加Url签名验证,防止恶意操作.
2. DEMO对应Url签名验证更新.

更新内容(2019年7月28日)     v1.41
1. 后台增加充值卡批量封卡,解封功能.
2. 输出接口增加充值卡被封返回码.

更新内容(2019年7月27日)     v1.40
1. 后台增加用户补偿功能(可自定义补偿天数)
2. 后台显示某用户登录日志排序调整(倒序显示)

更新内容(2019年7月24日)     v1.31
1. 后台系统设置增加是否开启加密输出开关.(默认关闭)
2. 优化验证前加载系统设置代码逻辑.

更新内容(2019年7月23日)     v1.30
1. 新增用户登录日志功能.
2. 后台单独列表化显示.(点击用户ID即可查询该用户近期10条登录记录,登录IP,时间)
3. 如删除某用户,该用户的登录日志也会随之删除.

更新内容(2019年7月21日)     v1.20
1. 验证登录接口动态加解密上线,服务端⇄客户端互通.
2. 易语言DEMO兼容动态加解密的验证.

更新内容(2019年7月19日 晚上) v1.11
1. 易语言DEMO新增在内存中调用远程DLL函数的示范.

更新内容(2019年7月19日 下午) v1.10
1. 系统设置增加版本号管理.
2. 系统设置增加DLL上传功能.(保存路径:public\upload\files)

功能介绍(2019年7月15日)    v1.00
1. 用户列表
2. 充值卡列表
3. 试用功能，可自定义试用的周期或关闭试用。
4. 充值卡批量生成。
5. 。。。。

## 有问题反馈

在使用中有任何问题，欢迎反馈给我，可以在Issues中或以下联系方式跟我交流。

## 关于作者

* Email：(jiayouzl#vip.qq.com, 把#换成@)
* QQ群：[20051836](//shang.qq.com/wpa/qunwpa?idkey=186c7daaf95c8306fd98c634511c56196ad0778529b22604c3326e518e0a29c1)
* Telegram：[https://t.me/hzleilei](https://t.me/hzleilei)
